(include "../../signature/programs/trees.eo")
(include "../../signature/programs/lists.eo")


; Unit tests for trees.eo programs

;---------------------------------
; $binary_tree_remove_elem
;---------------------------------

; Some constants to build arith terms for testing purposes
(declare-const a Int)
(declare-const b Real)

(declare-rule $test_$binary_tree_remove_elem ()
   :requires (
              (($binary_tree_remove_elem + ($f_list_cons + 1 2) 1)

               2)

              (($binary_tree_remove_elem + ($f_list_cons + 1 2) 2)

               1)

              (($binary_tree_remove_elem + ($f_list_cons + 1 ($f_list_cons + 2 3)) 1)

               ($f_list_cons + 2 3))

              (($binary_tree_remove_elem + ($f_list_cons + 1 ($f_list_cons + 2 3)) 2)

               ($f_list_cons + 1 3))

              (($binary_tree_remove_elem + ($f_list_cons + 1 ($f_list_cons + 2 3)) 3)

               ($f_list_cons + 1 2))

              (($binary_tree_remove_elem 
                + 
                ($f_list_cons + 1 
                              ($f_list_cons + 2 ($f_list_cons + 4 5))) 1)

               ($f_list_cons + 2 ($f_list_cons + 4 5)))

              (($binary_tree_remove_elem 
                + 
                ($f_list_cons + 1 
                              ($f_list_cons + 2 ($f_list_cons + 4 5))) 2)

               ($f_list_cons + 1 ($f_list_cons + 4 5)))

              (($binary_tree_remove_elem 
                + 
                ($f_list_cons + 1 
                              ($f_list_cons + 2 ($f_list_cons + 4 5))) 4)

               ($f_list_cons + 1 ($f_list_cons + 2 5)))

              (($binary_tree_remove_elem 
                + 
                ($f_list_cons + 1 
                              ($f_list_cons + 2 ($f_list_cons + 4 5))) 5)

               ($f_list_cons + 1 ($f_list_cons + 2 4)))
              )
   
   :conclusion-explicit true
   )

;---------------------------------
; $binary_tree_get_left_most_leaf
;---------------------------------

(declare-rule $test_$binary_tree_get_left_most_leaf ()
  :requires (; Addition
             (($binary_tree_get_left_most_leaf + ($f_list_cons + 2 1))

              2)

             (($binary_tree_get_left_most_leaf + ($f_list_cons + 
                                                               ($f_list_cons + 1 3)
                                                               2))

              1)

             (($binary_tree_get_left_most_leaf + ($f_list_cons +
                                                               ($f_list_cons * 1 3)
                                                               2))

              ($f_list_cons * 1 3))

             (($binary_tree_get_left_most_leaf 
               + ($f_list_cons +
                               ($f_list_cons + 
                                             ($f_list_cons * 1 3)
                                             1)
                               2))

              ($f_list_cons * 1 3))

             ; Product
             (($binary_tree_get_left_most_leaf * ($f_list_cons * 2 1))

              2)

             (($binary_tree_get_left_most_leaf * ($f_list_cons * 
                                                               ($f_list_cons * 1 3)
                                                               2))

              1)

             (($binary_tree_get_left_most_leaf * ($f_list_cons *
                                                               ($f_list_cons + 1 3)
                                                               2))

              ($f_list_cons + 1 3))

             (($binary_tree_get_left_most_leaf 
               * ($f_list_cons *
                               ($f_list_cons * 
                                             ($f_list_cons + 1 3)
                                             1)
                               2))

              ($f_list_cons + 1 3))
             )

  :conclusion-explicit true
  )


; Running every test.
(step test1 true :rule $test_$binary_tree_remove_elem)
(step test2 true :rule $test_$binary_tree_get_left_most_leaf)



